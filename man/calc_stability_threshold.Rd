% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_stability_threshold.R
\name{calc_stability_threshold}
\alias{calc_stability_threshold}
\title{Estimate the dynamic stability threshold of an ecological network}
\usage{
calc_stability_threshold(
  g,
  nsim = 1000,
  target_prob = 0.05,
  sd_start = -1,
  sd_step = -0.1,
  sd_min = -20,
  parallel = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{g}{An \code{igraph} ecological network.}

\item{nsim}{Integer. Number of QSS simulations per self-damping value.}

\item{target_prob}{Numeric. Target proportion of negative eigenvalues
(default = 0.05).}

\item{sd_start}{Numeric. Starting value of \code{selfDamping} (default = -1).}

\item{sd_step}{Numeric. Increment used to decrease \code{selfDamping}
(default = -0.1).}

\item{sd_min}{Numeric. Minimum (most negative) value allowed during search.}

\item{parallel}{Logical. Whether to run QSS simulations in parallel.}

\item{verbose}{Logical. Print diagnostic messages.
\subsection{Returns}{

A list with:
\item{threshold}{Interpolated \code{selfDamping} value where the target
proportion is reached.}
\item{sd_lower}{Lower bracketing self-damping value.}
\item{sd_upper}{Upper bracketing self-damping value.}
\item{prob_lower}{Proportion of negative eigenvalues at \code{sd_lower}.}
\item{prob_upper}{Proportion of negative eigenvalues at \code{sd_upper}.}
\item{sd_values}{All tested self-damping values.}
\item{probs}{Corresponding proportions of negative eigenvalues.}
\item{qss_interp}{Distribution of maximum eigenvalues at the interpolated
threshold value.}
}

\subsection{References}{

Allesina, S. & Pascual, M. (2008). Network structure, predator–prey modules,
and stability in large food webs. \emph{Theoretical Ecology}, \strong{1}, 55–64.

Grilli, J., Rogers, T. & Allesina, S. (2016). Modularity and stability in
ecological communities. \emph{Nature Communications}, \strong{7}, 12031.

Monteiro, A. B. & Del Bianco Faria, L. (2017). Causal relationships between
population stability and food-web topology. \emph{Functional Ecology}, \strong{31},
1294–1300.

Borrelli, J. J. (2015). Selection against instability: stable subgraphs are
most frequent in empirical food webs. \emph{Oikos}, \strong{124}, 1583–1588.
}}
}
\description{
This function estimates a stability threshold for an ecological network
using maximum eigenvalue simulations derived from the \code{\link[=calc_QSS]{calc_QSS()}}
function. The goal is to approximate the dynamical stability of a system
\emph{without requiring knowledge of the actual interaction strengths or the real
Jacobian matrix}.
}
\details{
\subsection{Conceptual Background}{

Real ecosystems persist over ecological timescales, which implies that their
underlying community matrices (Jacobians) must be locally stable—that is,
they produce a negative real part of the maximum eigenvalue. Because
interaction strengths and self-regulation parameters are rarely known,
stability must be inferred indirectly.

The \code{\link[=calc_QSS]{calc_QSS()}} function provides such an indirect method by
generating random Jacobian matrices whose \emph{sign structure} is determined by
the interaction network. Interaction magnitudes are drawn from a uniform
distribution whose limits are defined by the parameters \code{negative},
\code{positive}, and \code{selfDamping} (Assumed with default values in this function).

The QSS value is the proportion of simulated matrices that are locally
stable (i.e., have negative maximum eigenvalues). A higher QSS implies that
the network topology is more compatible with stable dynamics.
}

\subsection{Purpose of this Function}{

Because the true amount of self-regulation in a real system is unknown,
this function searches for the value of \code{selfDamping} for which a
target proportion of negative eigenvalues (typically 5\%) is produced. This
"stability threshold" represents the minimal level of self-regulation
required for the network to behave as a persistently stable system.

This approach follows the idea that:
\itemize{
\item Real food webs must be dynamically stable.
\item Stability requires some level of intraspecific self-regulation.
\item The amount of self-regulation needed \emph{depends on network structure}.
}

By interpolating the crossing point where the QSS proportion reaches a
target value (e.g., 0.05), we obtain an estimate of stability that can be
compared across networks—in the same spirit as structural stability,
modularity–stability relationships, and feasibility analysis.

For details, see References below.
}

\subsection{Parameters}{
}
}
\examples{
\dontrun{
g <- generate_niche(40, 0.1)
result <- calc_stability_threshold(g, nsim = 500)
plot_stability_curve(result)

# calculate the mean of the negative max eigenvalues at the threshold
mean(result$qss_raw_interp[result$qss_raw_interp < 0])

}

}
